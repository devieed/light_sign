<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>跑马灯备用方案</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      width: 100vw;
      height: 100vh;
      background: #000;
      overflow: hidden;
      font-family: Arial, sans-serif;
    }
    
    #marquee-container {
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      position: relative;
    }
    
    #marquee-text {
      color: #ffffff;
      font-size: 80px;
      font-weight: bold;
      white-space: nowrap;
      position: relative;
    }
    
    .controls {
      position: fixed;
      top: 20px;
      right: 20px;
      background: rgba(255, 255, 255, 0.9);
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
      z-index: 1000;
      max-height: 80vh;
      overflow-y: auto;
    }
    
    .controls h3 {
      margin-bottom: 15px;
      color: #333;
    }
    
    .control-group {
      margin-bottom: 15px;
    }
    
    .control-group label {
      display: block;
      margin-bottom: 5px;
      color: #555;
      font-weight: bold;
    }
    
    .control-group input[type="text"],
    .control-group input[type="number"],
    .control-group select {
      width: 100%;
      padding: 8px;
      border: 1px solid #ddd;
      border-radius: 5px;
      font-size: 14px;
    }
    
    .control-group input[type="color"] {
      width: 100%;
      height: 40px;
      border: 1px solid #ddd;
      border-radius: 5px;
      cursor: pointer;
    }
    
    button {
      width: 100%;
      padding: 10px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 5px;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      margin-top: 10px;
    }
    
    button:hover {
      opacity: 0.9;
    }
    
    .toggle-btn {
      position: fixed;
      bottom: 20px;
      right: 20px;
      width: 60px;
      height: 60px;
      border-radius: 50%;
      background: #667eea;
      color: white;
      font-size: 24px;
      border: none;
      cursor: pointer;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
      z-index: 999;
    }
    
    .hidden {
      display: none;
    }
  </style>
</head>
<body>
  <div id="marquee-container">
    <div id="marquee-text">Welcome to LED Scrolling Sign ✨</div>
  </div>
  
  <button class="toggle-btn" onclick="toggleControls()">⚙️</button>
  
  <div class="controls" id="controls">
    <h3>跑马灯设置</h3>
    
    <div class="control-group">
      <label>显示文字:</label>
      <input type="text" id="text" value="Welcome to LED Scrolling Sign ✨" maxlength="200">
    </div>
    
    <div class="control-group">
      <label>文字颜色:</label>
      <input type="color" id="textColor" value="#ffffff">
    </div>
    
    <div class="control-group">
      <label>背景颜色:</label>
      <input type="color" id="bgColor" value="#000000">
    </div>
    
    <div class="control-group">
      <label>字体大小: <span id="fontSizeValue">80</span>px</label>
      <input type="range" id="fontSize" min="20" max="300" value="80" step="5">
    </div>
    
    <div class="control-group">
      <label>滚动速度: <span id="speedValue">15</span>秒</label>
      <input type="range" id="speed" min="5" max="60" value="15" step="1">
    </div>
    
    <div class="control-group">
      <label>滚动方向:</label>
      <select id="direction">
        <option value="left">从右到左 ←</option>
        <option value="right">从左到右 →</option>
      </select>
    </div>
    
    <button onclick="applySettings()">应用设置</button>
    <button onclick="toggleFullscreen()" style="background: #3498db;">全屏显示</button>
  </div>
  
  <script>
    const marqueeText = document.getElementById('marquee-text')
    const marqueeContainer = document.getElementById('marquee-container')
    const controls = document.getElementById('controls')
    
    let animationFrame = null
    let position = 0
    let speed = 2 // 像素/帧
    let direction = 'left'
    
    // 使用 requestAnimationFrame 实现动画（最兼容的方式）
    function animate() {
      const containerWidth = marqueeContainer.offsetWidth
      const textWidth = marqueeText.offsetWidth
      
      if (direction === 'left') {
        position -= speed
        if (position < -textWidth / 2) {
          position = 0
        }
      } else {
        position += speed
        if (position > 0) {
          position = -textWidth / 2
        }
      }
      
      // 从容器中心开始
      const centerOffset = (containerWidth - textWidth) / 2
      marqueeText.style.transform = `translateX(${centerOffset + position}px)`
      animationFrame = requestAnimationFrame(animate)
    }
    
    // 应用设置
    function applySettings() {
      const text = document.getElementById('text').value
      const textColor = document.getElementById('textColor').value
      const bgColor = document.getElementById('bgColor').value
      const fontSize = document.getElementById('fontSize').value
      const speedValue = document.getElementById('speed').value
      direction = document.getElementById('direction').value
      
      // 重复文字以确保无缝滚动
      const repeatedText = `${text}        ${text}        ${text}        ${text}`
      marqueeText.textContent = repeatedText
      
      marqueeText.style.color = textColor
      marqueeText.style.fontSize = fontSize + 'px'
      marqueeContainer.style.backgroundColor = bgColor
      
      // 根据速度设置计算每帧移动距离
      speed = 100 / parseFloat(speedValue)
      
      // 重置位置
      if (direction === 'left') {
        position = 0
      } else {
        position = -marqueeText.offsetWidth / 2
      }
      
      console.log('设置已应用:', {
        text: text.substring(0, 30),
        textColor,
        bgColor,
        fontSize: fontSize + 'px',
        speed: speedValue + 's',
        direction
      })
    }
    
    // 切换控制面板
    function toggleControls() {
      controls.classList.toggle('hidden')
    }
    
    // 全屏
    function toggleFullscreen() {
      if (!document.fullscreenElement) {
        document.documentElement.requestFullscreen().catch(err => {
          console.log('全屏失败:', err)
        })
      } else {
        document.exitFullscreen()
      }
    }
    
    // 范围输入实时更新
    document.getElementById('fontSize').oninput = function() {
      document.getElementById('fontSizeValue').textContent = this.value
    }
    
    document.getElementById('speed').oninput = function() {
      document.getElementById('speedValue').textContent = this.value
    }
    
    // 初始化
    window.onload = function() {
      console.log('页面加载完成')
      console.log('marqueeText:', marqueeText)
      console.log('marqueeContainer:', marqueeContainer)
      
      applySettings()
      animate()
      
      console.log('动画已启动')
      console.log('如果你看到了这个但看不到文字，请告诉我')
    }
  </script>
</body>
</html>

